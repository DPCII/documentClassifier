US stocks end mostly higher as Nasdaq hits new record