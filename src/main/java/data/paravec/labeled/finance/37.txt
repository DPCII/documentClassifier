China deal lifts US stocks into record territory